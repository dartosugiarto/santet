<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Logic Extraction: Canvas Mode</title>
    <style>
        :root {
            --bg-canvas: #F5F5F7;
            --bg-ui: #FFFFFF;
            --text-primary: #1D1D1F;
            --accent-color: #0071E3;
            --border-color: #E5E5EA;
            --shadow-float: 0 8px 32px rgba(0, 0, 0, 0.08);
            --font-stack: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, sans-serif;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-stack);
            background-color: var(--bg-canvas);
            color: var(--text-primary);
            overflow-x: hidden;
        }

        /* --- 1. INFINITE CANVAS AREA --- */
        #canvas-container {
            position: relative;
            width: 100vw;
            height: 80vh; /* Porsi layar untuk diagram */
            background-image: 
                radial-gradient(#C7C7CC 1px, transparent 1px);
            background-size: 24px 24px;
            background-color: var(--bg-canvas);
            overflow: auto;
            cursor: grab;
            border-bottom: 1px solid var(--border-color);
        }

        #canvas-container:active { cursor: grabbing; }

        svg {
            display: block;
            min-width: 100%; 
            min-height: 100%;
        }

        /* Header Melayang */
        .floating-header {
            position: absolute;
            top: 24px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 10px 24px;
            border-radius: 50px;
            box-shadow: var(--shadow-float);
            border: 1px solid rgba(0,0,0,0.05);
            text-align: center;
            z-index: 100;
            pointer-events: none;
        }

        .floating-header h1 { font-size: 16px; margin: 0; font-weight: 600; }
        .floating-header p { font-size: 12px; margin: 2px 0 0 0; color: #86868B; }

        /* --- 2. NODE STYLES --- */
        .node-rect {
            fill: #FFFFFF;
            stroke: #D2D2D7;
            stroke-width: 2px;
            rx: 12;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.05));
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .node-group:hover .node-rect {
            stroke: var(--accent-color);
            transform: translateY(-2px);
            filter: drop-shadow(0 8px 16px rgba(0,113,227,0.2));
        }

        .node-text {
            font-size: 13px;
            font-weight: 500;
            fill: var(--text-primary);
            pointer-events: none;
            font-family: var(--font-stack);
        }

        .edge-path {
            fill: none;
            stroke: #B0B0B5;
            stroke-width: 2px;
            stroke-linecap: round;
        }

        .edge-label-bg { fill: var(--bg-canvas); }
        .edge-label {
            font-size: 10px;
            font-weight: 700;
            fill: var(--accent-color);
            text-transform: uppercase;
        }

        /* --- 3. PANEL BAWAH (Hanya Sintesis) --- */
        .details-panel {
            padding: 40px 20px;
            display: flex;
            justify-content: center; /* Center konten */
            background: #fff;
        }

        .synthesis-card {
            max-width: 700px;
            width: 100%;
            text-align: center;
        }
        
        .synthesis-card h2 {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #86868B;
            margin-bottom: 16px;
        }

        .synthesis-text {
            font-size: 16px;
            line-height: 1.6;
            color: #1D1D1F;
        }

    </style>
</head>
<body>

    <div id="canvas-container">
        <div class="floating-header">
            <h1>Logic Structure</h1>
            <p>Mysticism vs Science Analysis</p>
        </div>
        <svg id="logicSvg"></svg>
    </div>

    <div class="details-panel">
        <div class="synthesis-card">
            <h2>System Synthesis</h2>
            <p class="synthesis-text">
                Analisis logika menunjukkan bahwa atribusi fenomena fisik kepada <strong>"Mistika" (Santet)</strong> terjadi hanya ketika variabel <strong>Alat Ilmiah</strong> bernilai <em>FALSE</em>. <br><br>
                Ketika instrumen verifikasi diterapkan (<em>TRUE</em>), entitas penyakit seperti Hemofilia dan Kusta teridentifikasi sebagai gangguan biologis, bukan anomali metafisik. Diagram ini memvalidasi transisi dari asumsi mistis menuju pembuktian empiris.
            </p>
        </div>
    </div>

<script>
    // DATA LOGIC
    const logicData = {
        "nodes": [
            {"id": "N0", "label": "START: Phenomenon", "level": 0},
            {"id": "N1", "label": "? Scientific Tools Available", "level": 1, "type": "decision"},
            
            // Kiri (Mistis)
            {"id": "N2", "label": "Mystical Attribution", "level": 2},
            {"id": "N3", "label": "OUTPUT: Santet Idea", "level": 3, "type": "end"},

            // Kanan (Sains)
            {"id": "N4", "label": "Empirical Investigation", "level": 2},
            
            {"id": "N5", "label": "Bleeding Case", "level": 3},
            {"id": "N6", "label": "Hemophilia", "level": 4, "type": "end"},
            
            {"id": "N7", "label": "Skin Decay Case", "level": 3},
            {"id": "N8", "label": "Leprosy (M. leprae)", "level": 4, "type": "end"},
            
            {"id": "N9", "label": "Supernatural Test", "level": 3},
            {"id": "N10", "label": "CIA Stargate Project", "level": 4},
            {"id": "N11", "label": "Coincidence (Stat)", "level": 5, "type": "end"}
        ],
        "edges": [
            {"from": "N0", "to": "N1"},
            {"from": "N1", "to": "N2", "label": "NO"},
            {"from": "N2", "to": "N3"},
            {"from": "N1", "to": "N4", "label": "YES"},
            {"from": "N4", "to": "N5"}, {"from": "N5", "to": "N6"},
            {"from": "N4", "to": "N7"}, {"from": "N7", "to": "N8"},
            {"from": "N4", "to": "N9"}, {"from": "N9", "to": "N10"},
            {"from": "N10", "to": "N11"}
        ]
    };

    // RENDERER LOGIC
    function render() {
        const container = document.getElementById('canvas-container');
        const svg = document.getElementById('logicSvg');
        
        // Lebar dinamis, minimal 1200px agar nyaman discroll
        const width = Math.max(container.offsetWidth, 1200); 
        const height = 650;
        
        svg.style.width = width + "px";
        svg.style.height = height + "px";
        svg.innerHTML = '';

        const levelY = 100;
        const startY = 80;
        const nodeW = 160;
        const nodeH = 44;

        // Grouping
        const levels = {};
        logicData.nodes.forEach(n => {
            if(!levels[n.level]) levels[n.level] = [];
            levels[n.level].push(n);
        });

        const pos = {};

        // Calculate Position
        Object.keys(levels).forEach(lvl => {
            const nodes = levels[lvl];
            const segment = width / (nodes.length + 1);
            nodes.forEach((node, i) => {
                pos[node.id] = {
                    x: segment * (i + 1) - (nodeW/2),
                    y: startY + (node.level * levelY)
                };
            });
        });

        // Draw Edges
        logicData.edges.forEach(e => {
            const s = pos[e.from];
            const t = pos[e.to];
            if(s && t) {
                const sx = s.x + nodeW/2;
                const sy = s.y + nodeH;
                const tx = t.x + nodeW/2;
                const ty = t.y;

                const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
                const cY = (ty - sy) / 2;
                path.setAttribute("d", `M ${sx} ${sy} C ${sx} ${sy+cY}, ${tx} ${ty-cY}, ${tx} ${ty}`);
                path.setAttribute("class", "edge-path");
                if(e.label === "NO") path.setAttribute("stroke-dasharray", "4"); 
                svg.appendChild(path);

                if(e.label) {
                    const mx = (sx+tx)/2;
                    const my = (sy+ty)/2;
                    
                    const bg = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                    bg.setAttribute("x", mx - 15); bg.setAttribute("y", my - 8);
                    bg.setAttribute("width", 30); bg.setAttribute("height", 16);
                    bg.setAttribute("class", "edge-label-bg");
                    svg.appendChild(bg);

                    const txt = document.createElementNS("http://www.w3.org/2000/svg", "text");
                    txt.setAttribute("x", mx); txt.setAttribute("y", my + 4);
                    txt.setAttribute("text-anchor", "middle");
                    txt.setAttribute("class", "edge-label");
                    txt.textContent = e.label;
                    svg.appendChild(txt);
                }
            }
        });

        // Draw Nodes
        logicData.nodes.forEach(n => {
            const p = pos[n.id];
            const g = document.createElementNS("http://www.w3.org/2000/svg", "g");
            g.setAttribute("class", "node-group");
            
            const rect = document.createElementNS("http://www.w3.org/2000/svg", "rect");
            rect.setAttribute("x", p.x); rect.setAttribute("y", p.y);
            rect.setAttribute("width", nodeW); rect.setAttribute("height", nodeH);
            rect.setAttribute("class", "node-rect");
            
            // Style khusus
            if(n.type === 'end') rect.style.stroke = "#34C759";
            if(n.type === 'decision') rect.style.strokeDasharray = "4";

            const text = document.createElementNS("http://www.w3.org/2000/svg", "text");
            text.setAttribute("x", p.x + nodeW/2);
            text.setAttribute("y", p.y + nodeH/2 + 5);
            text.setAttribute("text-anchor", "middle");
            text.setAttribute("class", "node-text");
            text.textContent = n.label;

            g.appendChild(rect);
            g.appendChild(text);
            svg.appendChild(g);
        });
    }

    render();
    window.addEventListener('resize', render);

</script>
</body>
</html>
